{% extends 'blog/base.html' %}
{% block title %} posts {% endblock %}
{% load static %} 

{% block content %}
<h2>Blog Posts</h2>
<div>
    <form action="{% url 'search_posts' %}">
        <input type="search"name="search" placeholder="Search by title or content">
        <button type="submit">Search</button>
    </form>
</div>
<button> 
    <a href="{% url 'post_create' %}">Create a new post</a>
</button>

<ul class="comments">
    {% for post in posts %}
    <li class="comment">
        <h3>{{ post.title }}</h3>
        {% if post.tag.all %}
        <p>
            Tags: 
            {% for tag in post.tag.all %}
            <a href="{% url 'filter_posts_by_tag' tag.slug %}">{{ tag.name }}</a>
            {% if not forloop.last %}, {% endif %}
            {% endfor %}
        </p>
        {% endif %}
        <p>{{ post.content|truncatewords:30 }}</p>
        <p><em>By {{ post.author.username }} on {{ post.published_date }}</em></p>
        <a href="{% url 'post_detail' post.id %}">Read more</a>
    </li>
    {% empty %}
    <li>No posts available.</li>
    {% endfor %}
</ul>

{% endblock %}